<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.slim.min.js"></script>
<link href="/main.css" rel="stylesheet">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Document</title>
</head>
<body>
  <div id="app">
    <header th:replace="~{/fragment/header.html}"></header>
    <nav th:replace="~{/fragment/nav.html}"></nav>
    <main>
      <section>
        <table class="table">
          <tr>
            <td>작성일</td>
            <td th:text="${board.writeTime}"></td>
          </tr>
          <tr>
            <td>글쓴이</td>
            <td th:text="${board.writer}"></td>
          </tr>
          <tr>
            <td>제목</td>
            <td th:text="${board.title}"></td>
          </tr>
          <tr>
            <td colspan="2">
              <div style="min-height:400px; background-color:rgb(240,240,240);" th:text="${board.content}"></div>
            </td>
          </tr>
        </table>
        <div th:if="${isLogin && isWriter}">
          <!-- 로그인했고 글쓴이인 경우 -->
          <a class="btn btn-primary" th:href="${'/board/update?bno=' + board.bno}">변경으로</a>
          <button class="btn btn-danger" onclick="doDelete();">삭제하기</button>
        </div>
      </section>
    </main>
    <footer th:replace="~{/fragment/header.html}"></footer>
  </div>
  <!-- 자바스크립트에서 타임리프 값에 접근하는 코드 -->
  <script th:inline="javascript">
    const bno = [[${board.bno}]];
  </script>
  <script>
    function doDelete() {
      const html =`
        <form action="/board/delete" method="post">
          <input type="hidden" name="bno" value="${bno}">
        </form>
      `;
      // html로 jQuery객체를 만들어서 body에 붙인 다음 submit해라
      $(html).appendTo($('body')).submit();
    }
  </script>
</body>
</html>